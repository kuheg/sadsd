/*! For license information please see app.js.LICENSE.txt */
(()=>{var e,t,n,o,s={487:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},1012:e=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,o=0;n<e.length;n++,o+=8)t[o>>>5]|=e[n]<<24-o%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],o=0;o<e.length;o+=3)for(var s=e[o]<<16|e[o+1]<<8|e[o+2],a=0;a<4;a++)8*o+6*a<=8*e.length?n.push(t.charAt(s>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],o=0,s=0;o<e.length;s=++o%4)0!=s&&n.push((t.indexOf(e.charAt(o-1))&Math.pow(2,-2*s+8)-1)<<2*s|t.indexOf(e.charAt(o))>>>6-2*s);return n}},e.exports=n},8487:function(e,t,n){var o;o=void 0!==n.g?n.g:this,t.loadCSS=function(e,t,n,s){var a,i=o.document,r=i.createElement("link");if(t)a=t;else{var l=(i.body||i.getElementsByTagName("head")[0]).childNodes;a=l[l.length-1]}var c=i.styleSheets;if(s)for(var d in s)s.hasOwnProperty(d)&&r.setAttribute(d,s[d]);r.rel="stylesheet",r.href=e,r.media="only x",function e(t){if(i.body)return t();setTimeout((function(){e(t)}))}((function(){a.parentNode.insertBefore(r,t?a:a.nextSibling)}));var u=function(e){for(var t=r.href,n=c.length;n--;)if(c[n].href===t)return e();setTimeout((function(){u(e)}))};function m(){r.addEventListener&&r.removeEventListener("load",m),r.media=n||"all"}return r.addEventListener&&r.addEventListener("load",m),r.onloadcssdefined=u,u(m),r}},8738:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},2568:(e,t,n)=>{var o,s,a,i,r;o=n(1012),s=n(487).utf8,a=n(8738),i=n(487).bin,(r=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?i.stringToBytes(e):s.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=o.bytesToWords(e),l=8*e.length,c=1732584193,d=-271733879,u=-1732584194,m=271733878,g=0;g<n.length;g++)n[g]=16711935&(n[g]<<8|n[g]>>>24)|4278255360&(n[g]<<24|n[g]>>>8);n[l>>>5]|=128<<l%32,n[14+(l+64>>>9<<4)]=l;var h=r._ff,p=r._gg,f=r._hh,y=r._ii;for(g=0;g<n.length;g+=16){var v=c,b=d,w=u,E=m;c=h(c,d,u,m,n[g+0],7,-680876936),m=h(m,c,d,u,n[g+1],12,-389564586),u=h(u,m,c,d,n[g+2],17,606105819),d=h(d,u,m,c,n[g+3],22,-1044525330),c=h(c,d,u,m,n[g+4],7,-176418897),m=h(m,c,d,u,n[g+5],12,1200080426),u=h(u,m,c,d,n[g+6],17,-1473231341),d=h(d,u,m,c,n[g+7],22,-45705983),c=h(c,d,u,m,n[g+8],7,1770035416),m=h(m,c,d,u,n[g+9],12,-1958414417),u=h(u,m,c,d,n[g+10],17,-42063),d=h(d,u,m,c,n[g+11],22,-1990404162),c=h(c,d,u,m,n[g+12],7,1804603682),m=h(m,c,d,u,n[g+13],12,-40341101),u=h(u,m,c,d,n[g+14],17,-1502002290),c=p(c,d=h(d,u,m,c,n[g+15],22,1236535329),u,m,n[g+1],5,-165796510),m=p(m,c,d,u,n[g+6],9,-1069501632),u=p(u,m,c,d,n[g+11],14,643717713),d=p(d,u,m,c,n[g+0],20,-373897302),c=p(c,d,u,m,n[g+5],5,-701558691),m=p(m,c,d,u,n[g+10],9,38016083),u=p(u,m,c,d,n[g+15],14,-660478335),d=p(d,u,m,c,n[g+4],20,-405537848),c=p(c,d,u,m,n[g+9],5,568446438),m=p(m,c,d,u,n[g+14],9,-1019803690),u=p(u,m,c,d,n[g+3],14,-187363961),d=p(d,u,m,c,n[g+8],20,1163531501),c=p(c,d,u,m,n[g+13],5,-1444681467),m=p(m,c,d,u,n[g+2],9,-51403784),u=p(u,m,c,d,n[g+7],14,1735328473),c=f(c,d=p(d,u,m,c,n[g+12],20,-1926607734),u,m,n[g+5],4,-378558),m=f(m,c,d,u,n[g+8],11,-2022574463),u=f(u,m,c,d,n[g+11],16,1839030562),d=f(d,u,m,c,n[g+14],23,-35309556),c=f(c,d,u,m,n[g+1],4,-1530992060),m=f(m,c,d,u,n[g+4],11,1272893353),u=f(u,m,c,d,n[g+7],16,-155497632),d=f(d,u,m,c,n[g+10],23,-1094730640),c=f(c,d,u,m,n[g+13],4,681279174),m=f(m,c,d,u,n[g+0],11,-358537222),u=f(u,m,c,d,n[g+3],16,-722521979),d=f(d,u,m,c,n[g+6],23,76029189),c=f(c,d,u,m,n[g+9],4,-640364487),m=f(m,c,d,u,n[g+12],11,-421815835),u=f(u,m,c,d,n[g+15],16,530742520),c=y(c,d=f(d,u,m,c,n[g+2],23,-995338651),u,m,n[g+0],6,-198630844),m=y(m,c,d,u,n[g+7],10,1126891415),u=y(u,m,c,d,n[g+14],15,-1416354905),d=y(d,u,m,c,n[g+5],21,-57434055),c=y(c,d,u,m,n[g+12],6,1700485571),m=y(m,c,d,u,n[g+3],10,-1894986606),u=y(u,m,c,d,n[g+10],15,-1051523),d=y(d,u,m,c,n[g+1],21,-2054922799),c=y(c,d,u,m,n[g+8],6,1873313359),m=y(m,c,d,u,n[g+15],10,-30611744),u=y(u,m,c,d,n[g+6],15,-1560198380),d=y(d,u,m,c,n[g+13],21,1309151649),c=y(c,d,u,m,n[g+4],6,-145523070),m=y(m,c,d,u,n[g+11],10,-1120210379),u=y(u,m,c,d,n[g+2],15,718787259),d=y(d,u,m,c,n[g+9],21,-343485551),c=c+v>>>0,d=d+b>>>0,u=u+w>>>0,m=m+E>>>0}return o.endian([c,d,u,m])})._ff=function(e,t,n,o,s,a,i){var r=e+(t&n|~t&o)+(s>>>0)+i;return(r<<a|r>>>32-a)+t},r._gg=function(e,t,n,o,s,a,i){var r=e+(t&o|n&~o)+(s>>>0)+i;return(r<<a|r>>>32-a)+t},r._hh=function(e,t,n,o,s,a,i){var r=e+(t^n^o)+(s>>>0)+i;return(r<<a|r>>>32-a)+t},r._ii=function(e,t,n,o,s,a,i){var r=e+(n^(t|~o))+(s>>>0)+i;return(r<<a|r>>>32-a)+t},r._blocksize=16,r._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=o.wordsToBytes(r(e,t));return t&&t.asBytes?n:t&&t.asString?i.bytesToString(n):o.bytesToHex(n)}},655:(e,t,n)=>{n.d(t,{mG:()=>o});function o(e,t,n,o){return new(n||(n=Promise))((function(s,a){function i(e){try{l(o.next(e))}catch(e){a(e)}}function r(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}l((o=o.apply(e,t||[])).next())}))}}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return s[e].call(n.exports,n,n.exports,i),n.exports}i.m=s,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var s=Object.create(null);i.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var r=2&o&&n;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,i.d(s,a),s},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},o="sakurairo-scripts:",i.l=(e,t,s,a)=>{if(n[e])n[e].push(t);else{var r,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+s){r=u;break}}r||(l=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,i.nc&&r.setAttribute("nonce",i.nc),r.setAttribute("data-webpack",o+s),r.src=e),n[e]=[t];var m=(t,o)=>{r.onerror=r.onload=null,clearTimeout(g);var s=n[e];if(delete n[e],r.parentNode&&r.parentNode.removeChild(r),s&&s.forEach((e=>e(o))),t)return t(o)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=m.bind(null,r.onerror),r.onload=m.bind(null,r.onload),l&&document.head.appendChild(r)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={143:0};i.f.j=(t,n)=>{var o=i.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var s=new Promise(((n,s)=>o=e[t]=[n,s]));n.push(o[2]=s);var a=i.p+i.u(t),r=new Error;i.l(a,(n=>{if(i.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",r.name="ChunkLoadError",r.type=s,r.request=a,o[1](r)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,s,[a,r,l]=n,c=0;for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(l)l(i);for(t&&t(n);c<a.length;c++)s=a[c],i.o(e,s)&&e[s]&&e[s][0](),e[a[c]]=0},n=self.webpackChunksakurairo_scripts=self.webpackChunksakurairo_scripts||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{var e=i(655);function t(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function n(e,n){const o=indexedDB.open(e);o.onupgradeneeded=()=>o.result.createObjectStore(n);const s=t(o);return(e,t)=>s.then((o=>t(o.transaction(n,e).objectStore(n))))}let o;function s(){return o||(o=n("keyval-store","keyval")),o}const a=n("sakurairo","cache"),r=e=>function(e,n=s()){return n("readonly",(n=>t(n.get(e))))}(e,a),l=(e,n)=>function(e,n,o=s()){return o("readwrite",(o=>(o.put(n,e),t(o.transaction))))}(e,n,a),c=e=>function(e,n=s()){return n("readwrite",(n=>(n.delete(e),t(n.transaction))))}(e,a);let d=1,u="";const m=document.querySelector(".centerbg"),g=mashiro_option.rnd_site_bg?e=>{document.body.style.backgroundImage=`url(${e})`}:m?e=>{m.style.backgroundImage=`url(${e})`}:(console.warn(""),()=>{});function h(e=!1){const t=new URL(mashiro_option.cover_api);return document.body.clientWidth<860&&1==mashiro_option.random_graphs_mts?(t.searchParams.set("type","mobile"),t.toString()+(e?"&"+d:"")):t.toString()+(e?(""===t.search?"?":"&")+d:"")}function p(){URL.revokeObjectURL(u),u=""}function f(){return(0,e.mG)(this,void 0,void 0,(function*(){if(mashiro_option.land_at_home&&(!mashiro_option.site_bg_as_cover||(m.style.background="#0000","white-bg"===localStorage.getItem("bgImgSetting"))))if(mashiro_option.cache_cover){const t=yield r("cover");t?"object"==typeof t&&t instanceof Blob&&(p(),u=URL.createObjectURL(t),g(u)):g(h()),function(){(0,e.mG)(this,void 0,void 0,(function*(){try{const e=yield fetch(h());if(e.ok){const t=yield e.blob();l("cover",t)}}catch(e){"object"==typeof e&&e instanceof TypeError&&(console.warn("你的封面API好像不支持跨域调用,这种情况下缓存是不会生效的哦"),c("cover"))}}))}()}else g(h())}))}function y(e,t={},n=!0){const o=new URL(e),{searchParams:s}=o;for(const[e,n]of Object.entries(t))s.set(e,n);return n&&s.set("_wpnonce",Poi.nonce),o.toString()}var v;let b=null!==(v=mashiro_option.cookie_version_control)&&void 0!==v?v:"";function w(){const e=document.getElementsByClassName("butterBar");if(e.length>0)for(let t=0;t<e.length;t++)e[t].remove()}function E(e,t){w();const n=document.createElement("div");n.classList.add("butterBar","butterBar--center");const o=document.createElement("p");return o.classList.add("butterBar-message"),o.innerHTML=e,n.appendChild(o),document.body.appendChild(n),!0!==t&&setTimeout((()=>{w()}),"number"==typeof t?t:6e3),n}const _=["# 商业转载请联系作者获得授权，非商业转载请注明出处。","# For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source.","# 协议(License)：署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)","# 作者(Author)："+mashiro_option.author_name,"# 链接(URL)："+window.location.href,"# 来源(Source)："+mashiro_option.site_name];function L(e){const t=window.getSelection();if(t){const n=t.toString();n.length>30&&(!function(e,t){e.preventDefault();const n=_.join("<br>")+"<br><br>"+t.replace(/\r\n/g,"<br>"),o=_.join("\n")+"\n\n"+t.toString().replace(/\r\n/g,"\n");if(e.clipboardData)e.clipboardData.setData("text/html",n),e.clipboardData.setData("text/plain",o);else if(window.clipboardData)window.clipboardData.setData("text",o)}(e,n),E("复制成功！<br>Copied to clipboard successfully!",1e3))}}function S(){mashiro_option.clipboardCopyright&&(document.body.removeEventListener("copy",L),document.body.addEventListener("copy",L))}const k={respondId:"",moveForm:function(e,t,n){const o=document.getElementById(e),s=document.getElementById(n),a=document.getElementById("cancel-comment-reply-link"),i=document.getElementById("comment_parent");if(this.respondId=n,!document.getElementById("wp-temp-form-div")){let e;e=document.createElement("div"),e.id="wp-temp-form-div",e.style.display="none",s.parentNode.insertBefore(e,s)}if(o)o.parentNode.insertBefore(s,o.nextSibling);else{const e=document.getElementById("wp-temp-form-div");document.getElementById("comment_parent").value="0",e.parentNode.insertBefore(s,e),e.remove()}const r=document.getElementById("respond");window.scrollTo({top:r.getBoundingClientRect().top+window.pageYOffset-r.clientTop-100,behavior:"smooth"}),i.value=t,a.style.display="",a.onclick=function(e){var t=k,n=document.getElementById("wp-temp-form-div"),o=document.getElementById(t.respondId);return document.getElementById("comment_parent").value="0",n&&o&&(n.parentNode.insertBefore(o,n),n.remove()),this.style.display="none",this.onclick=null,!1};try{document.getElementById("comment").focus()}catch(e){}return!1}},B=k;var I=i(8487);const q={src:"data-src",srcset:"data-srcset",selector:".lazyload",root:null,rootMargin:"0px",threshold:0};class T{constructor(e,t){this.observer=null,this.settings=Object.assign(Object.assign({},q),t),this.images=e||document.querySelectorAll(this.settings.selector),this.init()}init(){if(!IntersectionObserver)return void this.loadImages();const e=this;let t={root:this.settings.root,rootMargin:this.settings.rootMargin,threshold:[this.settings.threshold]};this.observer=new IntersectionObserver((function(t){Array.prototype.forEach.call(t,(function(t){if(t.isIntersecting){e.observer.unobserve(t.target);let n=t.target.getAttribute(e.settings.src),o=t.target.getAttribute(e.settings.srcset);"img"===t.target.tagName.toLowerCase()?(n&&(t.target.src=n),o&&(t.target.srcset=o)):t.target.style.backgroundImage="url("+n+")"}}))}),t),this.images.forEach((t=>{e.observer.observe(t)}))}loadAndDestroy(){this.settings&&(this.loadImages(),this.destroy())}loadImages(){if(!this.settings)return;const e=this;Array.prototype.forEach.call(this.images,(function(t){let n=t.getAttribute(e.settings.src),o=t.getAttribute(e.settings.srcset);"img"===t.tagName.toLowerCase()?(n&&(t.src=n),o&&(t.srcset=o)):t.style.backgroundImage="url('"+n+"')"}))}destroy(){this.settings&&(this.observer.disconnect(),this.settings=null)}}const x=(e,t)=>new T(e,t);var C=i(2568),N=i.n(C);const j=[".bili",".menhera",".tieba"];window.imgError=function(e,t){switch(t){case 1:e.src="https://view.moezx.cc/images/2017/12/30/Transparent_Akkarin.th.jpg";break;case 2:e.src="https://sdn.geekzu.org/avatar/?s=80&d=mm&r=g";break;default:e.src="https://view.moezx.cc/images/2018/05/13/image-404.png"}},window.cmt_showPopup=function(e){let t=e.querySelector("#thePopup");t.classList.add("show"),e.querySelector("input").onblur=()=>{t.classList.remove("show")}},window.coverVideo=function(){let e=document.getElementById("coverVideo"),t=document.getElementById("coverVideo-btn");if(e.paused){e.play();try{t.innerHTML='<i class="fa fa-pause" aria-hidden="true"></i>'}catch{}}else{e.pause();try{t.innerHTML='<i class="fa fa-play" aria-hidden="true"></i>'}catch{}}},window.killCoverVideo=function(){var e=document.getElementById("coverVideo"),t=document.getElementById("coverVideo-btn");if(e.paused);else{e.pause();try{t.innerHTML='<i class="fa fa-play" aria-hidden="true"></i>'}catch(e){}}},window.mail_me=function(){var e="mailto:"+mashiro_option.email_name+"@"+mashiro_option.email_domain;window.open(e)},window.headertop_down=function(){let e=document.getElementById("content").getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:e,behavior:"smooth"})},window.motionSwitch=function(e){for(let e=0;e<j.length;e++)document.querySelector(j[e]+"-bar").classList.remove("on-hover"),document.querySelector(j[e]+"-container").style.display="none";document.querySelector(e+"-bar").classList.add("on-hover"),document.querySelector(e+"-container").style.display="block"},window.grin=function(e,t,n,o){let s;switch(t){case"custom":e=n+e+o;break;case"Img":e="[img]"+e+"[/img]";break;case"Math":e=" {{"+e+"}} ";break;case"tieba":e=" ::"+e+":: ";break;default:e=" :"+e+": "}if(!document.getElementById("comment")||"textarea"!=document.getElementById("comment").type)return!1;if(s=document.getElementById("comment"),document.selection)s.focus(),sel=document.selection.createRange(),sel.text=e,s.focus();else if(s.selectionStart||"0"==s.selectionStart){let t=s.selectionStart,n=s.selectionEnd,o=n;s.value=s.value.substring(0,t)+e+s.value.substring(n,s.value.length),o+=e.length,s.focus(),s.selectionStart=o,s.selectionEnd=o}else s.value+=e,s.focus()},window.get_gravatar=(e,t=80)=>"https://"+Poi.gravatar_url+"/"+N()(e)+".jpg?s="+t+"&d=mm";let A,P;function O(e){return()=>{const{name:t}=e.dataset;t!=localStorage.getItem("font_family")&&("serif"==t?(document.body.clientWidth<=860&&E("将从网络加载字体，流量请注意"),document.body.classList.add("serif"),A&&A.classList.add("selected"),P&&P.classList.remove("selected"),localStorage.setItem("font_family","serif")):(document.body.classList.remove("serif"),A&&A.classList.remove("selected"),P&&P.classList.add("selected"),localStorage.setItem("font_family","sans-serif")))}}function H(){const e=localStorage.getItem("font_family");e&&"serif"!=e?"sans-serif"==e&&(A.classList.remove("selected"),P.classList.add("selected")):document.body.classList.add("serif")}function M(){A=document.getElementsByClassName("control-btn-serif")[0],P=document.getElementsByClassName("control-btn-sans-serif")[0],A.addEventListener("click",O(A)),P.addEventListener("click",O(P)),H()}const R=window.matchMedia("(prefers-color-scheme:dark)");let D=!1;function U(e){console.log("夜间模式"+(e?"开启":"关闭")),e!==D&&(document.dispatchEvent(new CustomEvent("darkmode",{detail:e})),D=e)}function z(){localStorage.getItem("dark")||(R.matches&&mashiro_option.darkmode?V():Y())}function F(e){e==W()?localStorage.removeItem("dark"):1==e?localStorage.setItem("dark","1"):localStorage.setItem("dark","0")}function V(e){document.documentElement.style.background="#333",document.getElementsByClassName("site-content")[0].style.backgroundColor="#333",document.body.classList.add("dark"),e&&F(!0),U(!0)}function Y(e){document.documentElement.style.background="unset",document.getElementsByClassName("site-content")[0].style.backgroundColor="rgba(255, 255, 255, .8)",document.body.classList.remove("dark"),document.body.classList.remove("dynamic"),U(!1),e&&F(!1)}function $(){const e=new Date;return e.getHours()>21||e.getHours()<7}function W(){switch(mashiro_option.dm_strategy){case"time":return $();case"client":return R.matches;case"eien":return!0;default:return $()}}"client"===mashiro_option.dm_strategy&&(R.removeEventListener?R.removeEventListener("change",z):R.removeListener(z),R.addEventListener?R.addEventListener("change",z):R.addListener(z));const G=(()=>{const e=navigator.userAgent,t=-1!=e.indexOf("Chrome")?/(Chrome)\/(\d+)/i:/(Firefox|Chrome|Version|Opera)\/(\d+)/i,n=e.match(t);return Poi.pjax=n&&parseInt(n[2])>={Firefox:84,Edg:88,Chrome:88,Opera:74,Version:9}[n[1]]&&Poi.pjax,0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")&&function(e,t,n){const o=n?"; expires="+new Date(Date.now()+24*n*60*60*1e3).toUTCString():"";document.cookie=e+b+"="+(t||"")+o+"; path=/"}("su_webp","1",114514),Poi.pjax&&i.e(842).then(i.t.bind(i,8842,23)).then((({default:e})=>new e({selectors:["#page","title",".footer-device","#_mashiro_"],elements:["a:not([target='_top']):not(.comment-reply-link):not(#pagination a):not(#comments-navi a):not(.user-menu-option a):not(.header-user-avatar a):not(.emoji-item):not(.no-pjax)",".search-form",".s-search"],timeout:8e3,history:!0,cacheBust:!1})))})(),X=function(e){if("complete"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)};mashiro_global.variables=new function(){this.has_hls=!1,this.skinSecter=!0},mashiro_global.ini=new function(){this.normalize=function(){x(),Z(),ce(),je(),le(),ne(),document.body.clientWidth>860&&window.addEventListener("scroll",(()=>{let e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.scrollHeight||document.body.scrollHeight,n=window.innerHeight,o=parseInt(e/(t-n)*100);document.getElementById("bar").style.width=o+"%";let s=document.querySelector(".toc-container"),a=document.querySelector(".site-content"),i=document.querySelector(".skin-menu");s&&a&&(s.style.height=((e,t)=>e<t?e:t)(a.getBoundingClientRect().height,document.documentElement.offsetHeight-s.offsetTop)+"px"),i&&i.classList.remove("show")})),fe(),me()},this.pjax=function(){ue(),Z(),ce(),je(),le(),ne(),fe(),me(),Se()}};const J=(()=>{var e,t;function n(e,t){const n={autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",contenteditable:"false",design:"by Mashiro"};if(!e.children[0])return;const o=e.children[0].className;let s=o.substr(0,o.indexOf(" ")).replace("language-","");"hljs"==s.toLowerCase()&&(s=t.className.replace("hljs","")?t.className.replace("hljs",""):"text"),e.classList.add("highlight-wrap");for(const t in n)e.setAttribute(t,n[t]);t.setAttribute("data-rel",s.toUpperCase())}async function o(e,t){try{await async function(){try{window.hljs||(window.hljs=await Promise.all([i.e(869),i.e(870),i.e(450),i.e(130),i.e(135),i.e(356),i.e(412),i.e(455),i.e(140),i.e(191),i.e(732),i.e(914)]).then(i.t.bind(i,7869,23)),await i.e(241).then(i.t.bind(i,5241,23)))}catch(e){console.warn(e)}}();for(let e=0;e<t.length;e++)hljs.highlightBlock(t[e]);for(let o=0;o<e.length;o++)n(e[o],t[o]);hljs.initLineNumbersOnLoad();const o=document.querySelector(".entry-content");o&&o.addEventListener("click",(function(e){e.target.classList.contains("highlight-wrap")&&(e.target.classList.toggle("code-block-fullscreen"),document.documentElement.classList.toggle("code-block-fullscreen-html-scroll"))}))}catch(e){console.warn(e)}}const s=null!==(e=null===(t=mashiro_option.code_highlight_prism)||void 0===t?void 0:t.autoload_path)&&void 0!==e?e:"https://cdn.jsdelivr.net/npm/prismjs@1.23.0/";let a;const r=(()=>{var e,t;const{light:n,dark:o}=null!==(e=null===(t=mashiro_option.code_highlight_prism)||void 0===t?void 0:t.theme)&&void 0!==e?e:{},a={light:null!=n?n:"themes/prism.min.css",dark:null!=o?o:"themes/prism-tomorrow.min.css"};for(const e in a)a[e]=new URL(a[e],s).toString();return a})();function l(e){const t=e?r.dark:r.light;if(a){if(a.href!==t){const e=(0,I.loadCSS)(t);e.addEventListener("load",(()=>{a.remove(),a=e}))}}else a=(0,I.loadCSS)(t)}async function c(){try{if(!window.Prism){const{default:e}=await i.e(660).then(i.t.bind(i,5660,23));window.Prism=e}(0,I.loadCSS)(new URL("plugins/toolbar/prism-toolbar.min.css",s).toString()),(0,I.loadCSS)(new URL("plugins/previewers/prism-previewers.min.css",s).toString()),l(D),document.addEventListener("darkmode",(e=>{l(e.detail)})),await Promise.all([i.e(475).then(i.t.bind(i,3475,23)),i.e(470).then(i.t.bind(i,9470,23)),i.e(206).then(i.t.bind(i,5206,23)).then((()=>i.e(695).then(i.t.bind(i,2695,23))))]),Prism.plugins.autoloader.languages_path=new URL("components/",s).toString()}catch(e){console.warn(e)}}function d(){return(0,I.loadCSS)(new URL("plugins/line-numbers/prism-line-numbers.min.css",s).toString()),i.e(759).then(i.t.bind(i,8759,23))}return async function(){const e=document.getElementsByTagName("pre"),t=document.querySelectorAll("pre code");if(e.length)switch(mashiro_option.code_highlight){case"hljs":return o(e,t);case"prism":return async function(e){try{await c(),mashiro_option.code_highlight_prism.line_number_all&&(document.querySelector(".entry-content").classList.add("line-numbers"),await d()),e.forEach((async e=>{e.parentElement.classList.contains("line-numbers")&&await d(),e.classList.contains("match-braces")&&(await i.e(873).then(i.t.bind(i,7873,23)),(0,I.loadCSS)(new URL("plugins/match-braces/prism-match-braces.min.css",s).toString())),Prism.highlightElement(e)})),Prism.plugins.fileHighlight&&Prism.plugins.fileHighlight.highlight()}catch(e){console.warn(e)}}(t);case"custom":return;default:console.warn(`mashiro_option.code_highlight这咋填的是个${mashiro_option.code_highlight}啊🤔`)}}})();function Q(e,t=1e3,n="",o){let s=e;s.status=s.status||getComputedStyle(s,null).display;const a="none"!=s.status;1==a&&"show"==n||0==a&&"hide"==n||(s.status=a?"none":"block",s.style.transition="height "+t/1e3+"s",s.style.overflow="hidden",clearTimeout(s.tagTimer),s.tagTimer=s.tagTimer||null,s.style.display="block",s.tagHeight=s.tagHeight||s.clientHeight+"px",s.style.display="",s.style.height=a?s.tagHeight:"0px",setTimeout((()=>{s.style.height=a?"0px":s.tagHeight}),0),s.tagTimer=setTimeout((()=>{s.style.display=a?"none":"block",s.style.transition="",s.style.overflow="",s.style.height="",s.status=s.tagHeight=null}),t),o&&o())}function Z(){if(document.querySelector("article")&&document.querySelector("article").classList.contains("post-list-thumb")){const e=new IntersectionObserver((t=>{t.forEach((t=>{window.IntersectionObserver?t.target.classList.contains("post-list-show")?(t.target.style.willChange="auto",e.unobserve(t.target)):t.isIntersecting&&(t.target.classList.add("post-list-show"),t.target.style.willChange="auto",e.unobserve(t.target)):(t.target.style.willChange="auto",!1===t.target.classList.contains("post-list-show")&&t.target.classList.add("post-list-show"))}))}),{root:null,threshold:[.66]}),t=document.getElementsByClassName("post-list-thumb");for(let n=0;n<t.length;n++)e.observe(t[n])}}function K(){const e=document.querySelector(".form-submit #submit");if(null==e)return;if(!mashiro_option.comment_upload_img)return void(e.style.width="100%");e.insertAdjacentHTML("afterend",'<div class="insert-image-tips popup"><i class="fa fa-picture-o" aria-hidden="true"></i><span class="insert-img-popuptext" id="uploadTipPopup">上传图片</span></div><input id="upload-img-file" type="file" accept="image/*" multiple="multiple" class="insert-image-button">'),function(){let e=document.getElementsByClassName("insert-image-tips")[0],t=document.getElementById("upload-img-file");t&&t.addEventListener("change",(function(){if(this.files.length>10)return E("每次上传上限为10张.<br>10 files max per request."),0;for(let e=0;e<this.files.length;e++)if(this.files[e].size>=5242880)return void alert("图片上传大小限制为5 MB.\n5 MB max per file.\n\n「"+this.files[e].name+"」\n\n这张图太大啦~请重新上传噢！\nThis image is too large~Please reupload!");for(let t=0;t<this.files.length;t++){let n=this.files[t],o=new FormData,s=new XMLHttpRequest;o.append("cmt_img_file",n),s.addEventListener("loadstart",(function(){e.innerHTML='<i class="fa fa-spinner rotating" aria-hidden="true"></i>',E("上传中...<br>Uploading...")})),s.open("POST",y(Poi.api+"sakura/v1/image/upload"),!0),s.send(o),s.onreadystatechange=function(){if(4!=s.readyState||200!=s.status&&304!=s.status)4==s.readyState&&(e.innerHTML='<i class="fa fa-times" aria-hidden="true" style="color:red"></i>',alert("上传失败，请重试.\nUpload failed, please try again."),setTimeout((function(){e.innerHTML='<i class="fa fa-picture-o" aria-hidden="true"></i>'}),1e3));else{e.innerHTML='<i class="fa fa-check" aria-hidden="true"></i>',setTimeout((function(){e.innerHTML='<i class="fa fa-picture-o" aria-hidden="true"></i>'}),1e3);let t=JSON.parse(s.responseText);if(200==t.status){let e=t.proxy;document.getElementById("upload-img-show").insertAdjacentHTML("afterend",'<img class="lazyload upload-image-preview" src="https://cdn.jsdelivr.net/gh/Fuukei/Public_Repository@latest/vision/theme/colorful/load/inload.svg" data-src="'+e+'" onclick="window.open(\''+e+'\')" onerror="imgError(this)" />'),x(),E("图片上传成功~<br>Uploaded successfully~"),grin(e,type="Img")}else E("上传失败！<br>Uploaded failed!<br> 文件名/Filename: "+n.name+"<br>code: "+t.status+"<br>"+t.message,3e3)}}}}))}();const t=document.getElementById("upload-img-file"),n=document.getElementsByClassName("insert-image-tips")[0],o=document.getElementById("uploadTipPopup");t&&(t.addEventListener("mouseenter",(function(){n.classList.toggle("insert-image-tips-hover"),o.classList.toggle("show")})),t.addEventListener("mouseleave",(function(){n.classList.toggle("insert-image-tips-hover"),o.classList.toggle("show")})))}function ee(){document.getElementsByClassName("comment_inline_img").length&&document.getElementsByClassName("comments-main")[0].addEventListener("click",(function(e){e.target.classList.contains("comment_inline_img")&&window.open(e.target.src)}))}function te(){document.getElementsByClassName("emoji-item").length&&document.querySelector(".menhera-container").addEventListener("click",(function(e){e.target.classList.contains("emoji-item")&&grin(e.target.innerText,"custom","`","` ")}))}function ne(){if(!1===mashiro_global.variables.skinSecter){const e=document.querySelector(".pattern-center"),t=document.querySelector(".headertop-bar");e&&(e.classList.remove("pattern-center"),e.classList.add("pattern-center-sakura")),t&&(t.classList.remove("headertop-bar"),t.classList.add("headertop-bar-sakura"))}else{const e=document.querySelector(".pattern-center-sakura"),t=document.querySelector(".headertop-bar-sakura");e&&(e.classList.remove("pattern-center-sakura"),e.classList.add("pattern-center")),t&&(t.classList.remove("headertop-bar-sakura"),t.classList.add("headertop-bar"))}}function oe(){const e=document.getElementById("primary");e&&e.addEventListener("contextmenu",(function(e){"img"==e.target.nodeName.toLowerCase()&&(e.preventDefault(),e.stopPropagation())}))}function se(e){let t;switch(mashiro_global.variables.skinSecter="white-bg"==e||"dark-bg"==e,ne(),e){case"white-bg":t=mashiro_option.rnd_site_bg?h():mashiro_option.skin_bg0;break;case"diy1-bg":t=mashiro_option.skin_bg1;break;case"diy2-bg":t=mashiro_option.skin_bg2;break;case"diy3-bg":t=mashiro_option.skin_bg3;break;case"diy4-bg":t=mashiro_option.skin_bg4}const n=document.body.style.backgroundImage;n!=t&&(mashiro_option.cache_cover&&n.match(/^url\("blob:/)||(document.body.style.backgroundImage=t?`url(${t})`:""))}function ae(){const e=document.getElementById("bg-next"),t=document.getElementById("bg-pre");e&&(e.onclick=()=>{p(),g(h(!0)),d++}),t&&(t.onclick=()=>{p(),d--,g(h(!0))})}function ie(e){let t=document.getElementById("archives");if(null==t)return;let n=t.getElementsByClassName("al_mon");1==e?(t.addEventListener("click",(function(e){e.target.classList.contains("al_mon")&&(Q(e.target.nextElementSibling,500),e.preventDefault())})),x()):function(){let e=document.getElementById("al_expand_collapse");e.style.cursor="s-resize";for(let e=0;e<n.length;e++){let t=n[e],o=t.nextElementSibling.getElementsByTagName("li").length;t.style.cursor="s-resize",t.querySelector("#post-num").textContent=o}let o=t.getElementsByClassName("al_post_list"),s=o[0];for(let e=0;e<o.length;e++)Q(o[e],500,"hide",(function(){Q(s,500,"show")}));if(t.addEventListener("click",(function(e){e.target.classList.contains("al_mon")&&(Q(e.target.nextElementSibling,500),e.preventDefault())})),document.body.clientWidth>860){for(let e=0;e<o.length;e++){let t=o[e];t.parentNode.addEventListener("mouseover",(function(){return Q(t,500,"show"),!1}))}0;let t=0;e.addEventListener("click",(function(){if(0==t){for(let e=0;e<o.length;e++){Q(o[e],500,"show")}t++}else if(1==t){for(let e=0;e<o.length;e++){Q(o[e],500,"hide")}t--}}))}}()}function re(){const e=document.getElementById("coverVideo"),t=document.getElementById("coverVideo").getAttribute("data-src");if(Hls.isSupported()){const n=new Hls;n.loadSource(t),n.attachMedia(e),n.on(Hls.Events.MANIFEST_PARSED,(function(){e.play()}))}else e.canPlayType("application/vnd.apple.mpegurl")&&(e.src=t,e.addEventListener("loadedmetadata",(function(){e.play()})))}function le(){let e=document.getElementsByTagName("video")[0];e&&e.classList.contains("hls")&&(mashiro_global.variables.has_hls?re():i.e(631).then(i.t.bind(i,7631,23)).then((e=>{window.Hls=e.default,re(),mashiro_global.variables.has_hls=!0})).catch((e=>console.warn("Hls load failed: ",e))))}function ce(){const e=document.querySelectorAll("pre code");if(e.length>0){for(let t=0;t<e.length;t++)e[t].setAttribute("id","code-block-"+t),e[t].insertAdjacentHTML("afterend",'<a class="copy-code" href="javascript:" data-clipboard-target="#code-block-'+t+'" title="拷贝代码"><i class="fa fa-clipboard" aria-hidden="true"></i>');i.e(152).then(i.t.bind(i,2152,23)).then((({default:e})=>{new e(".copy-code")}))}}function de(e){if(!(document.body.clientWidth<=1200))if(document.querySelector("div.have-toc")||document.querySelector("div.has-toc")){if(e){let e=1,t="sakura"==mashiro_option.entry_content_theme?document.querySelector("article.type-post")?document.querySelector("div.pattern-attachment-img")?-75:200:375:window.innerHeight/2,n=document.querySelectorAll(".entry-content,.links");for(let t=0;t<n.length;t++){let o=n[t].querySelectorAll("h1,h2,h3,h4,h5");for(let t=0;t<o.length;t++)o[t].id="toc-head-"+e,e++}i.e(866).then(i.t.bind(i,2866,23)).then((({default:e})=>{e.init({tocSelector:".toc",contentSelector:[".entry-content",".links"],headingSelector:"h1, h2, h3, h4, h5",headingsOffset:t-window.innerHeight/2})}))}}else{let e=document.getElementsByClassName("toc-container")[0];e&&(e.remove(),e=null)}}J(),ee(),te(),oe(),ie(),de(!0);const ue=function(){K(),oe(),ee(),te(),H();let e=document.getElementsByTagName("p");for(let t=0;t<e.length;t++)e[t].classList.remove("head-copyright");try{J()}catch(e){console.warn(e)}try{pe()}catch(e){console.warn(e)}x();let t=document.getElementsByTagName("div"),n=document.getElementById("to-load-aplayer");n&&n.addEventListener("click",(()=>{for(let e=0;e<t.length;e++)t[e].classList.remove("load-aplayer")}));let o=document.getElementsByClassName("iconflat");0!=o.length&&(o[0].style.width="50px",o[0].style.height="50px");let s=document.getElementsByClassName("openNav");0!=s.length&&(s[0].style.height="50px"),ae(),he(),ie(),S(),de(!0)};function me(){let e=document.getElementsByClassName("sm"),t=document.querySelector(".comments-main");e.length&&("new"==Poi.reply_link_version&&t&&t.addEventListener("click",(function(e){if(e.target.classList.contains("comment-reply-link")){e.preventDefault(),e.stopPropagation();let t=e.target.getAttribute("data-commentid");B.moveForm("comment-"+t,t,"respond",this.getAttribute("data-postid"))}})),t&&t.addEventListener("click",(e=>{let t=e.target.parentNode;if(t.classList.contains("sm")){if(1==confirm("您真的要设为私密吗？")){if(t.classList.contains("private_now"))return alert("您之前已设过私密评论"),!1;{t.classList.add("private_now");let e=t.getAttribute("data-idp"),n=t.getAttribute("data-actionp"),o=t.getElementsByClassName("has_set_private")[0],s="action=siren_private&p_id="+e+"&p_action="+n,a=new XMLHttpRequest;return a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(o.innerHTML=a.responseText)},a.open("POST","/wp-admin/admin-ajax.php",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(s),!1}}alert("已取消")}})))}let ge=document.getElementsByClassName("comt-addsmilies");function he(){let e=document.getElementById("emotion-toggle");e&&e.addEventListener("click",(function(){document.querySelector(".emotion-toggle-off").classList.toggle("emotion-hide"),document.querySelector(".emotion-toggle-on").classList.toggle("emotion-show"),document.querySelector(".emotion-box").classList.toggle("emotion-box-show")}))}function pe(){let e=!1;const t=document.querySelector("input#author"),n=document.querySelector("input#qq"),o=document.querySelector("input#email"),s=document.querySelector("input#url"),a=document.querySelector(".qq-check"),i=document.querySelector(".gravatar-check"),r=document.querySelector("div.comment-user-avatar img");if(null==t)return;localStorage.getItem("user_qq")||localStorage.getItem("user_qq_email")||localStorage.getItem("user_author")||(n.value=t.value=o.value=s.value=""),localStorage.getItem("user_avatar")&&localStorage.getItem("user_qq")&&localStorage.getItem("user_qq_email")&&(r.setAttribute("src",localStorage.getItem("user_avatar")),t.value=localStorage.getItem("user_author"),o.value=localStorage.getItem("user_qq")+"@qq.com",n.value=localStorage.getItem("user_qq"),mashiro_option.qzone_autocomplete&&(s.value="https://user.qzone.qq.com/"+localStorage.getItem("user_qq")),n.value&&(a.style.display="block",i.style.display="none"));let l=o.value;t.addEventListener("blur",(()=>{const c=t.value;if(/^[1-9]\d{4,9}$/.test(c)){const d=()=>{n.value="",a.style.display="none",i.style.display="block",r.setAttribute("src",get_gravatar(o.value,80)),localStorage.setItem("user_qq",""),localStorage.setItem("user_email",o.value),localStorage.setItem("user_avatar",get_gravatar(o.value,80))};fetch(y(mashiro_option.qq_api_url,{qq:c})).then((async u=>{if(u.ok)try{const d=await u.json();t.value=d.name,o.value=c.trim()+"@qq.com",mashiro_option.qzone_autocomplete&&(s.value="https://user.qzone.qq.com/"+c.trim()),r.setAttribute("src","https://q2.qlogo.cn/headimg_dl?dst_uin="+c+"&spec=100"),e=!0,n.value=c.trim(),n.value&&(a.style.display="block",i.style.display="none"),localStorage.setItem("user_author",d.name),localStorage.setItem("user_qq",c),localStorage.setItem("is_user_qq","yes"),localStorage.setItem("user_qq_email",c+"@qq.com"),localStorage.setItem("user_email",c+"@qq.com"),l=o.value,r.setAttribute("src",d.avatar),localStorage.setItem("user_avatar",d.avatar)}catch(e){console.warn(e),d()}else d()}))}})),localStorage.getItem("user_avatar")&&localStorage.getItem("user_email")&&"no"==localStorage.getItem("is_user_qq")&&!localStorage.getItem("user_qq_email")&&(r.setAttribute("src",localStorage.getItem("user_avatar")),o.value=localStorage.getItem("user_mail"),n.value="",n.value||(a.style.display="none",i.style.display="block")),o.addEventListener("blur",(function(){let t=o.value;0!=e&&l==t||""==t||(r.setAttribute("src",get_gravatar(t,80)),localStorage.setItem("user_avatar",get_gravatar(t,80)),localStorage.setItem("user_email",t),localStorage.setItem("user_qq_email",""),localStorage.setItem("is_user_qq","no"),n.value="",n.value||(a.style.display="none",i.style.display="block"))})),localStorage.getItem("user_url")&&(s.value=localStorage.getItem("user_url")),s.addEventListener("blur",(function(){let e=s.value;s.value=e,localStorage.setItem("user_url",e)})),localStorage.getItem("user_author")&&(t.value=localStorage.getItem("user_author")),t.addEventListener("blur",(function(){let e=t.value;t.value=e,localStorage.setItem("user_author",e)}))}function fe(){const e=document.getElementsByTagName("section");let t=!1;for(let n=0;n<e.length;n++)if(e[n].classList.contains("bangumi")){t=!0;break}t&&document.addEventListener("click",(function(e){const t=e.target;if(t===document.querySelector("#bangumi-pagination a")){e.preventDefault(),e.stopPropagation(),t.classList.add("loading"),t.textContent="";const n=new XMLHttpRequest;n.open("POST",t.href+"&_wpnonce="+Poi.nonce,!0),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){let e=JSON.parse(n.responseText),t=document.getElementById("bangumi-pagination"),o=document.getElementsByClassName("row")[0];t.remove(),o.insertAdjacentHTML("beforeend",e)}else t.classList.remove("loading"),t.innerHTML='<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> ERROR '},n.send()}}))}ge.length>0&&Array.from(ge,(e=>{e.addEventListener("click",(()=>{"block"==e.stlye.display?e.style.display="none":e.style.display="block"}))})),document.querySelectorAll(".comt-smilies a").forEach((e=>{e.addEventListener("click",(()=>{e.parentNode.style.display="none"}))})),he(),S(),mashiro_option.float_player_on&&document.body.clientWidth>860&&i.e(297).then(i.bind(i,3297)).then((({aplayerInit:e})=>e())),setTimeout((function(){!function(){let e=document.getElementById("secondary");if(document.body.clientWidth>860){let t=document.querySelector(".show-hide");t&&t.addEventListener("click",(function(){e&&e.classList.toggle("active")}))}else e&&e.remove()}()}),100),mashiro_global.ini.normalize(),(0,I.loadCSS)(mashiro_option.jsdelivr_css_src),(0,I.loadCSS)(mashiro_option.entry_content_style_src),(0,I.loadCSS)("https://at.alicdn.com/t/font_679578_qyt5qzzavdo39pb9.css");const ye=document.getElementById("bgvideo");function ve(){let e=document.getElementById("video-btn");e&&(e.classList.add("video-pause"),e.classList.remove("video-play"),e.style.display="");try{if(document.querySelector(".video-stu").style.bottom="-100px",document.querySelector(".focusinfo").style.top="-999px",mashiro_option.float_player_on)return void i.e(297).then(i.bind(i,3297)).then((({destroyAllAplayer:e})=>{e(),ye.play()}))}catch(e){console.warn(e)}ye.play()}function be(){let e=document.getElementById("video-btn");e&&(e.classList.add("video-play"),e.classList.remove("video-pause"));try{document.querySelector(".focusinfo").style.top="49.3%"}catch{}ye.pause()}function we(){let e=document.getElementsByClassName("video-stu")[0];e.innerHTML="正在载入视频 ...",e.style.bottom="0px";let t=Poi.movies.name.split(","),n=t[Math.floor(Math.random()*t.length)],o=document.getElementById("bgvideo");o.setAttribute("src",Poi.movies.url+"/"+n+".mp4"),o.setAttribute("video-name",n)}function Ee(){if("auto"==Poi.windowheight){if(document.querySelector("h1.main-title")){const e=document.getElementById("centerbg"),t=document.getElementById("bgvideo");e&&(e.style.height="100vh"),t&&(t.style.minHeight="100vh")}}else document.querySelector(".headertop")&&document.querySelector(".headertop").classList.add("headertop-bar")}function _e(){if(document.querySelector(".headertop")){let e=document.querySelector(".headertop"),t=document.querySelector(".blank");if(document.querySelector(".main-title")){try{t.style.paddingTop="0px"}catch(e){}e.style.height="auto",e.style.display="","open"==Poi.movies.live&&null!=ye.oncanplay&&document.querySelector(".haslive")&&document.querySelector(".videolive")&&ve()}else{try{t.style.paddingTop="75px"}catch(e){}e.style.height="0px",e.style.display="none",function(){if(null!=ye.oncanplay&&document.querySelector(".haslive")){be();let e=document.getElementsByClassName("video-stu")[0];e.style.bottom="0px",e.innerHTML="已暂停 ..."}}()}}}function Le(){let e=document.querySelector(".comments-hidden"),t=document.querySelector(".comments-main");null!=e&&(e.style.display="block",t.style.display="none",e.addEventListener("click",(function(){Q(t,500,"show"),e.style.display="none"})));let n=document.getElementsByClassName("archives");if(n.length>0){for(let e=0;e<n.length;e++)n[e].style.display="none";n[0].style.display="";let e=document.getElementById("archives-temp").getElementsByTagName("h3");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),Q(e.target.nextElementSibling,300)}))}!function(){const e=document.getElementsByClassName("collapseButton");if(e.length>0){const t=e=>{Q(e.target.parentNode.parentNode.parentNode.querySelector(".xContent"))};for(const n of e)n.addEventListener("click",t)}mashiro_option.baguetteBoxON?((0,I.loadCSS)("https://cdn.jsdelivr.net/npm/baguettebox.js@1.11.1/dist/baguetteBox.min.css"),i.e(731).then(i.t.bind(i,5731,23)).then((({default:e})=>{e.run(".entry-content",{captions:function(e){return e.getElementsByTagName("img")[0].alt},ignoreClass:"fancybox"})}))):mashiro_option.fancybox&&((0,I.loadCSS)("https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"),i.e(755).then(i.t.bind(i,9755,23)).then((e=>{window.jQuery=e.default,window.$=e.default,i.e(155).then(i.t.bind(i,4155,23))})))}();const o=function(){if(document.getElementsByClassName("js-toggle-search")[0].classList.toggle("is-active"),document.getElementsByClassName("js-search")[0].classList.toggle("is-visible"),document.documentElement.style.overflowY="hidden",mashiro_option.live_search){var e=[];r=y(Poi.api+"sakura/v1/cache_search/json"),null!=sessionStorage.getItem("search")?(i(e=JSON.parse(sessionStorage.getItem("search")),document.getElementById("search-input").value,n),s()):fetch(r).then((async o=>{if(o.ok){const a=await o.text();""!=a&&(sessionStorage.setItem("search",a),i(e=JSON.parse(a),t.value,n),s())}else console.warn("HTTP "+o.status)})).catch((e=>console.warn(e)));var t=document.getElementById("search-input"),n=document.getElementById("PostlistBox").innerHTML,o=null;function s(){const e=document.querySelector(".search_close"),t=document.getElementById("Ty");for(const n of document.getElementsByClassName("ins-selectable"))n.addEventListener("click",(()=>{t.href=n.getAttribute("href"),t.click(),e.click()}))}function a(e,t,n,o,s,a,i){if(e){var r=e.trim().split(" "),l=o.indexOf(r[r.length-1]),c=i.indexOf(r[r.length-1]);o=(o=l<60?o.slice(0,80):o.slice(l-30,l+30)).replace(r[r.length-1],'<mark class="search-keyword"> '+r[r.length-1].toUpperCase()+" </mark>"),i=(i=c<60?i.slice(0,80):i.slice(c-30,c+30)).replace(r[r.length-1],'<mark class="search-keyword"> '+r[r.length-1].toUpperCase()+" </mark>")}return'<div class="ins-selectable ins-search-item" href="'+t+'"><header><i class="fa fa-'+n+'" aria-hidden="true"></i>'+o+'<i class="iconfont icon-'+s+'"> '+a+'</i></header><p class="ins-search-preview">'+i+"</p></div>"}function i(e,t,n){var o,s="",i="",r="",l="",c="",d="",u="",m='<section class="ins-section"><header class="ins-section-header">',g="</section>",h="</header>",p=function(e,t){for(let e=0;e<t.length;e++)-1!=[".","?","*"].indexOf(t[e])&&(t=t.slice(0,e)+"\\"+t.slice(e),e++);return t=t.replace(t,"^(?=.*?"+t+").+$").replace(/\s/g,")(?=.*?"),e.filter((e=>Object.values(e).some((e=>new RegExp(t+"").test(e)))))}(e,t.trim());for(o=0;o<Object.keys(p).length;o++)switch((u=p[o]).type){case"post":i+=a(t,u.link,"file",u.title,"mark",u.comments,u.text);break;case"tag":c+=a("",u.link,"tag",u.title,"none","","");break;case"category":l+=a("",u.link,"folder",u.title,"none","","");break;case"page":r+=a(t,u.link,"file",u.title,"mark",u.comments,u.text);break;case"comment":d+=a(t,u.link,"comment",u.title,"none","",u.text)}i&&(s=s+m+"文章"+h+i+g),r&&(s=s+m+"页面"+h+r+g),l&&(s=s+m+"分类"+h+l+g),c&&(s=s+m+"标签"+h+c+g),d&&(s=s+m+"评论"+h+d+g),document.getElementById("PostlistBox").innerHTML=s}t.oninput=function(){null==o&&clearTimeout(o),o=setTimeout((function(){i(e,t.value,n),s()}),250)}}var r};for(const e of document.getElementsByClassName("js-toggle-search"))e.addEventListener("click",o);const s=document.querySelector(".search_close");s&&s.addEventListener("click",(function(){let e=document.getElementsByClassName("js-search")[0];e.classList.contains("is-visible")&&(document.getElementsByClassName("js-toggle-search")[0].classList.toggle("is-active"),e.classList.toggle("is-visible"),document.documentElement.style.overflowY="unset")}));try{let e=document.getElementById("show-nav");e.addEventListener("click",(function(){if(e.classList.contains("showNav")){e.classList.remove("showNav"),e.classList.add("hideNav");let t=document.querySelector(".site-top .lower nav");t&&t.classList.add("navbar")}else{e.classList.remove("hideNav"),e.classList.add("showNav");let t=document.querySelector(".site-top .lower nav");t&&t.classList.remove("navbar")}})),document.getElementById("loading").addEventListener("click",(function(){let e=document.getElementById("loading");e.classList.add("hide"),e.classList.remove("show")}))}catch(e){}}function Se(){const e=document.querySelector(".site-header");window.addEventListener("scroll",(()=>{(document.documentElement.scrollTop||window.pageYOffset)>0?e.classList.add("yya"):e.classList.remove("yya")}))}const ke=(e=>{let t=!1;return(...n)=>{if(!t){t=!0;try{const o=e(...n);return o instanceof Promise?o.finally((()=>t=!1)):t=!1,o}catch(e){console.warn(e),t=!1}}}})((function(){const e=document.location.href,t=document.querySelector("#pagination a");t.classList.add("loading"),t.innerText="",fetch(t.getAttribute("href")+"#main").then((async n=>{const o=await n.text(),s=(new DOMParser).parseFromString(o,"text/html"),a=s.querySelectorAll("#main .post"),i=s.querySelector("#pagination a"),r=i&&i.innerText,l=i&&i.getAttribute("href"),c=document.getElementById("main");if(e!=document.location.href)return;for(let e=0;e<a.length;e++)c.append(a[e]);Poi.pjax&&(await G).refresh(document.querySelector("#content"));const d=document.querySelector("#pagination a"),u=document.querySelector("#add_post span");if(d&&(d.classList.remove("loading"),d.innerText=r),u&&(u.classList.remove("loading"),u.innerText=""),x(),Z(),null!=l){t.setAttribute("href",l);let e=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;window.scrollTo({top:e+300,behavior:"smooth"})}else document.getElementById("pagination").innerHTML="<span>很高兴你翻到这里，但是真的没有了...</span>"}))}));function Be(){let e;new IntersectionObserver((function(t){if(t[0].intersectionRatio<=0)return;const n=document.querySelector("#pagination a");if(n){const t=n.getAttribute("href"),o=document.getElementById("add_post_time");if(null!=t&&o){const t=document.getElementById("add_post_time").title;"233"!=t&&(console.log("%c 自动加载时倒计时 %c","background:#9a9da2; color:#ffffff; border-radius:4px;","","",t),e=setTimeout((function(){ke()}),1e3*t))}}})).observe(document.querySelector(".footer-device")),document.body.addEventListener("click",(function(t){t.target==document.querySelector("#pagination a")&&(t.preventDefault(),t.stopPropagation(),clearTimeout(e),ke())}))}function Ie(){const e="commentwrap",t=document.getElementById("commentform");if(t){let n=!1;t.addEventListener("submit",(function(t){if(t.stopPropagation(),t.preventDefault(),n)return;const o=E("提交中(Commiting)....",!0),s=new FormData(this);s.append("action","ajax_comment"),n=!0,fetch(Poi.ajaxurl,{method:this.attributes.method.value,body:s}).then((async t=>{const n=await t.text();if(t.ok){Array.from(document.getElementsByTagName("textarea")).forEach((e=>e.value=""));const t=document.getElementById("cancel-comment-reply-link"),o=document.getElementById("wp-temp-form-div"),s=document.getElementById(B.respondId);"0"!=document.getElementById("comment_parent").value?document.getElementById("respond").insertAdjacentHTML("beforebegin",'<ol class="children">'+n+"</ol>"):document.getElementsByClassName(e).length?"asc"==Poi.order?document.getElementsByClassName("commentwrap")[1].insertAdjacentHTML("beforeend",n):document.getElementsByClassName("commentwrap")[1].insertAdjacentHTML("afterbegin",n):"bottom"==Poi.formpostion?document.getElementById("respond").insertAdjacentHTML("beforebegin",'<ol class="'+e+'">'+n+"</ol>"):document.getElementById("respond").insertAdjacentHTML("afterend",'<ol class="'+e+'">'+n+"</ol>"),E("提交成功(Succeed)"),x(),J(),ee(),document.getElementById("upload-img-show").innerHTML="",t.style.display="none",t.onclick=null,document.getElementById("comment_parent").value="0",o&&s&&(o.parentNode.insertBefore(s,o),o.remove())}else E(null!=n?n:"HTTP"+t.status+":"+t.statusText)})).catch((e=>{E(e)})).finally((()=>{o.remove(),n=!1}))}))}}function qe(){let e=document.querySelector("#moblieGoTop"),t=document.querySelector("#changskin");window.addEventListener("scroll",(()=>{(document.documentElement.scrollTop||document.body.scrollTop)>20?(e.style.transform="scale(1)",t.style.transform="scale(1)"):(e.style.transform="scale(0)",t.style.transform="scale(0)")})),e.onclick=function(){window.scrollTo({top:0,behavior:"smooth"})}}function Te(){if(mashiro_option.yiyan){const e=document.getElementById("footer_yiyan");e&&fetch("https://api.maho.cc/yiyan/").then((async t=>{const n=await t.json();e.innerText=n.hitokoto+"——"+n.from}))}}Poi.pjax&&(document.addEventListener("pjax:send",(()=>{for(const e of document.getElementsByClassName("normal-cover-video"))e.pause(),e.src="",e.load="";document.getElementById("bar").style.width="0%",mashiro_option.NProgressON&&i.e(865).then(i.t.bind(i,4865,23)).then((({default:e})=>{e.start()})),document.body.classList.contains("navOpen")&&(document.body.classList.toggle("navOpen"),document.getElementById("main-container").classList.toggle("open"),document.getElementById("mo-nav").classList.toggle("open"),document.querySelector(".openNav").classList.toggle("open"))})),document.addEventListener("pjax:complete",(function(){Ee(),Te(),_e(),Le(),mashiro_option.land_at_home&&Be(),mashiro_option.NProgressON&&i.e(865).then(i.t.bind(i,4865,23)).then((({default:e})=>{e.done()})),mashiro_global.ini.pjax();let e=document.getElementById("loading");e&&(e.classList.add("hide"),e.classList.remove("show")),document.querySelector(".js-search.is-visible")&&(document.getElementsByClassName("js-toggle-search")[0].classList.toggle("is-active"),document.getElementsByClassName("js-search")[0].classList.toggle("is-visible"),document.documentElement.style.overflowY="unset")})),document.addEventListener("pjax:success",(function(){window.gtag&&gtag("config",Poi.google_analytics_id,{page_path:window.location.pathname})})),document.addEventListener("pjax:error",(e=>{E("文章加载出错了 HTTP "+e.request.status)})),window.addEventListener("popstate",(function(e){Ee(),Te(),_e(),Le(),me(),ie(!0),Z()}),!1));let xe=navigator.userAgent.toLowerCase().indexOf("webkit")>-1,Ce=navigator.userAgent.toLowerCase().indexOf("opera")>-1,Ne=navigator.userAgent.toLowerCase().indexOf("msie")>-1;function je(){if(mashiro_option.audio&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)){let e,t=new AudioContext,n="880 987 1046 987 1046 1318 987 659 659 880 784 880 1046 784 659 659 698 659 698 1046 659 1046 1046 1046 987 698 698 987 987 880 987 1046 987 1046 1318 987 659 659 880 784 880 1046 784 659 698 1046 987 1046 1174 1174 1174 1046 1046 880 987 784 880 1046 1174 1318 1174 1318 1567 1046 987 1046 1318 1318 1174 784 784 880 1046 987 1174 1046 784 784 1396 1318 1174 659 1318 1046 1318 1760 1567 1567 1318 1174 1046 1046 1174 1046 1174 1567 1318 1318 1760 1567 1318 1174 1046 1046 1174 1046 1174 987 880 880 987 880".split(" "),o=0,s=1,a="♪ ♩ ♫ ♬ ♭ € § ¶ ♯".split(" ");document.querySelectorAll(".site-title, #moblieGoTop, .site-branding, .searchbox, .changeSkin-gear, .menu-list li").forEach((i=>{i.addEventListener("mouseenter",(i=>{if(e)return;let r=n[o];r||(o=0,r=n[o]),o+=s;const l=t.createOscillator(),c=t.createGain();l.connect(c),c.connect(t.destination),l.type="sine",l.frequency.value=r,c.gain.setValueAtTime(0,t.currentTime),c.gain.linearRampToValueAtTime(1,t.currentTime+.01),l.start(t.currentTime),c.gain.exponentialRampToValueAtTime(.001,t.currentTime+1),l.stop(t.currentTime+1);const d=Math.round(7*Math.random()),u=i.pageX,m=i.pageY-5;e=document.createElement("b"),e.textContent=a[d],e.style.zIndex="99999",e.style.top=m-100+"px",e.style.left=u+"px",e.style.position="absolute",e.style.color="#FF6EB4",document.body.appendChild(e),e.animate([{top:m+"px"},{opacity:0}],{duration:500}),setTimeout((()=>{e.remove(),e=null}),500),i.stopPropagation()}))}))}}(xe||Ce||Ne)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",(function(){let e,t=location.hash.substring(1);/^[A-z0-9_-]+$/.test(t)&&(e=document.getElementById(t),e&&(/^(?:a|select|input|button|textarea)$/i.test(e.tagName)||(e.tabIndex=-1),e.focus()))}),!1);const Ae=document.getElementById("preload");Ae&&window.addEventListener("load",(()=>{if(document.documentElement.style.overflowY="unset",0!=mashiro_option.preload_blur)try{return void(Ae.animate([{filter:"blur(0px)",backdropFilter:"blur(10px)",opacity:1},{backdropFilter:"blur(0px)grayscale(0)",opacity:.1},{opacity:0,filter:"blur(100px)"}],{duration:mashiro_option.preload_blur,fill:"forwards",easing:"ease"}).onfinish=()=>{Ae.remove()})}catch(e){console.warn(e)}Ae.classList.add("hide"),Ae.classList.remove("show"),setTimeout((()=>Ae.remove()),233)})),X((function(){function e(){document.querySelector(".skin-menu").classList.remove("show"),setTimeout((function(){null!=document.querySelector(".changeSkin-gear")&&(document.querySelector(".changeSkin-gear").style.visibility="visible")}),300)}f(),document.querySelectorAll(".menu-list li").forEach((t=>{t.addEventListener("click",(function(){const t=this.id;"dark-bg"==t?V(!0):(Y(!0),se(t),localStorage.setItem("bgImgSetting",t)),e()}))})),function(){const e=localStorage.getItem("bgImgSetting");e&&se(e)}(),function(){const e=localStorage.getItem("dark");e?"1"==e?V():Y():W()&&mashiro_option.darkmode?V():Y()}();let t=document.querySelector("#changskin"),n=document.querySelector(".skin-menu #close-skinMenu");t&&t.addEventListener("click",(function(){document.querySelector(".skin-menu").classList.toggle("show")})),n&&n.addEventListener("click",(function(){e()})),K()})),X((function(){Ee(),_e(),Se(),qe(),Be(),Ie(),document.body.addEventListener("click",(function(e){if(e.target.parentNode==document.getElementById("comments-navi")&&"a"==e.target.nodeName.toLowerCase()){e.preventDefault(),e.stopPropagation();let t=e.target,n=t.pathname,o=new XMLHttpRequest;o.open("GET",t.getAttribute("href"),!0),o.responseType="document",o.onloadstart=()=>{let e=document.getElementById("comments-navi"),t=document.querySelector("ul.commentwrap"),n=document.getElementById("loading-comments"),o=document.getElementById("comments-list-title");e.remove(),t.remove(),n.style.display="block",Q(n,500,"show"),window.scrollTo({top:o.getBoundingClientRect().top+window.pageYOffset-o.clientTop-65,behavior:"smooth"})},o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){let e=o.response,t=e.querySelector("ul.commentwrap"),s=e.getElementById("comments-navi");Q(document.getElementById("loading-comments"),200,"hide"),document.getElementById("loading-comments").insertAdjacentHTML("afterend",t.outerHTML),document.querySelector("ul.commentwrap").insertAdjacentHTML("afterend",s.outerHTML),x(),window.gtag&&gtag("config",Poi.google_analytics_id,{page_path:n}),J(),ee();let a=document.querySelector("ul.commentwrap");window.scrollTo({top:a&&a.getBoundingClientRect().top+window.pageYOffset-a.clientTop-200,behavior:"smooth"})}},o.send()}})),Le(),function(){let e=document.querySelector(".iconflat");e&&e.addEventListener("click",(function(){document.body.classList.toggle("navOpen"),document.getElementById("main-container").classList.toggle("open"),document.getElementById("mo-nav").classList.toggle("open"),document.querySelector(".openNav").classList.toggle("open")}))}(),async function(){const e=(await i.e(213).then(i.t.bind(i,5213,23))).default;e.colorful=!0,e.shake=!1,document.body.addEventListener("input",e)}(),function(){let e=document.getElementById("video-btn");e&&e.addEventListener("click",(function(){this.classList.contains("loadvideo")?(this.classList.add("video-pause"),this.classList.remove("loadvideo"),we(),ye.oncanplay=function(){ve(),document.getElementById("video-add").style.display="block",e.classList.add("videolive","haslive")}):this.classList.contains("video-pause")?(be(),e.classList.remove("videolive"),document.getElementsByClassName("video-stu")[0].style.bottom="0px",document.getElementsByClassName("video-stu")[0].innerHTML="已暂停 ..."):(ve(),e.classList.add("videolive")),ye.onended=function(){ye.setAttribute("src",""),document.getElementById("video-add").style.display="none",e&&e.classList.add("loadvideo"),e&&e.classList.remove("video-pause","videolive","haslive"),document.querySelector(".focusinfo").style.top="49.3%"}}));const t=document.getElementById("video-add");t&&t.addEventListener("click",(function(){we()}))}(),Te(),M(),pe(),ae(),je(),console.log("%c Mashiro %c","background:#24272A; color:#ffffff","","https://2heng.xin/"),console.log("%c Github %c","background:#24272A; color:#ffffff","","https://github.com/mashirozx")}))})()})();
//# sourceMappingURL=app.js.map